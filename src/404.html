<!-- 404.html -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Page Not Found</title>
    <script>
      (function() {
        // Configuration
        var baseHref = '/kamoska-windows/';
        
        // Check if we're already in a redirect (URL contains ?p=)
        if (window.location.search.includes('?p=')) {
          // We're already in a redirect, don't redirect again
          return;
        }

        var pathSegmentsToKeep = baseHref.split('/').filter(p => p).length;
        var loc = window.location;
        
        // Remove any duplicate base href segments from the path
        var fullPath = loc.pathname;
        var pattern = new RegExp(`^${baseHref}+`, 'g');
        var cleanPath = fullPath.replace(pattern, baseHref);
        
        // Get the path segments after our base href
        var remainingPath = cleanPath.split('/').slice(pathSegmentsToKeep).join('/');
        
        // Construct the redirect URL (only once)
        var newUrl = loc.protocol + '//' + loc.hostname + 
                    (loc.port ? ':' + loc.port : '') +
                    baseHref +
                    '?p=/' + remainingPath +
                    (loc.search ? '&q=' + loc.search.slice(1) : '') +
                    loc.hash;
        
        // Perform the redirect
        window.location.replace(newUrl);
      })();
    </script>
  </head>
  <body>
    <h1>Page Not Found</h1>
    <p>Redirecting to homepage...</p>
  </body>
</html>